function [B updatedG] = trainBasisFromFolder(basicParameter)

dataSet = getFileListWithExtension('*.mp3');

Xtotal = [];
sheetMatrixtotal = [];

window = basicParameter.window;
noverlap = basicParameter.noverlap;

if strcmp(basicParameter.scale, 'stft') | strcmp(basicParameter.scale, 'midi')

    for j = 1:length(dataSet)

        filename = char(dataSet(j));
        MIDIFilename = strcat(filename,'.mid');
        MP3Filename =  strcat(filename, '.mp3');

        Xtemp = audio2spectrogram(MP3Filename, basicParmaeter);

        Xtotal = horzcat(Xtotal, Xtemp);

        nmat = readmidi_java(MIDIFilename, true);
        nmat(:,7) = nmat(:,6) + nmat(:,7);

        sheetMatrixTemporal = midi2MatrixOption(nmat, size(Xtemp,2), basicParameter);
        sheetMatrixtotal = horzcat(sheetMatrixtotal, sheetMatrixTemporal);

    end

    [updatedG B] = basisNMFoption(Xtotal, sheetMatrixtotal, basicParameter, 100);

    
    
elseif strcmp(basicParameter.scale
    for j = 1:length(dataSet)

        filename = char(dataSet(j));
        MIDIFilename = strcat(filename,'.mid');
        MP3Filename =  strcat(filename, '.mp3');

        [Xtemp, f, al = audio2erbt(MP3Filename, basicParmaeter);

        Xtotal = horzcat(Xtotal, Xtemp);

        nmat = readmidi_java(MIDIFilename, true);
        nmat(:,7) = nmat(:,6) + nmat(:,7);

        sheetMatrixTemporal = midi2MatrixOption(nmat, size(Xtemp,2), basicParameter);
        sheetMatrixtotal = horzcat(sheetMatrixtotal, sheetMatrixTemporal);

    end

    [updatedG B] = basisNMFoption(Xtotal, sheetMatrixtotal, basicParameter, 100);

end
